---
title: "4PopSims"
author: "Jennifer Blanc"
date: "2024-01-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(tidyverse)
```

```{r}
df <- fread("../plots/A/q_A1.txt")
for (i in 2:50) {
  
  tmp <- fread(paste0("../plots/A/q_A", i, ".txt"))
  df <- rbind(df, tmp)
}
```

```{r}

dfPlot <- df %>% group_by(config, gwas_size, test_size, h2, ts, num_causal, env, L, type) %>% summarize(count = n(), avg_q = mean(`nc-q`),lowerci_mean = avg_q - (1.96 * (sd(`nc-q`)  /  sqrt(n()))), upperci_mean = avg_q + (1.96 * (sd(`nc-q`)  /  sqrt(n()))), fp_strat = sum(`nc-p` < 0.05)/ n(), lowerci_fp = fp_strat - 1.96 * sqrt((fp_strat * (1-fp_strat))/ n()), upperci_fp = fp_strat + 1.96 * sqrt((fp_strat * (1-fp_strat))/ n()) )


dfPlot %>% filter(config =="C1", gwas_size == 10000, test_size == 10000) %>% ggplot(aes(x = env, y = fp_strat, color = type)) + geom_point() + facet_wrap(~L)

dfPlot %>% filter(config =="C1", gwas_size == 1000, test_size == 10000) %>% ggplot(aes(x = env, y = avg_q, color = type)) + geom_point() + facet_wrap(~L)

```

